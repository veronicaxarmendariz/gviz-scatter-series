<!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
-->
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Google Visualization ScatterChart Series by JackDougherty</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="//www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ['corechart']});
    </script>
    <script type="text/javascript">
    var visualization;

    function drawVisualization() {
      // To see the data that this visualization uses, browse to
      // https://docs.google.com/spreadsheet/ccc?key=0AtmGKybdRLlZdHBvSGxIdEJoc1YxNUxtTThGbU9Qcnc
      // In your Google Sheet, copy the key in the URL and paste in below
      // Adjust the cell range (e.g. A1:G7) to match data in your Google Sheet
      // In your Google Sheet, File > Publish to the Web
      var query = new google.visualization.Query(
          'http://spreadsheets.google.com/tq?key=0AtmGKybdRLlZdHBvSGxIdEJoc1YxNUxtTThGbU9Qcnc&range=A1:G7&pub=1');
    
      // Send the query with a callback function.
      query.send(handleQueryResponse);
    }
    
    function handleQueryResponse(response) {
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
      // Set data series (3 in this sample) to match your Google Sheet. 
      // Set property for each tooltip column in your GoogleSheet (first = 0)
      var data = response.getDataTable();
      data.setColumnProperty(2, 'role', 'tooltip');
      data.setColumnProperty(4, 'role', 'tooltip');
      data.setColumnProperty(6, 'role', 'tooltip');
      visualization = new google.visualization.ScatterChart(document.getElementById('visualization'));
      // Insert titles, labels, font sizes, and legend/data series colors below.
      // If Google Sheet data is not percents, reset maxValue and remove format. 
      // Modify legend labels via Y-series column headers in Google Sheet.
      // See more ScatterChart options at 
      // https://developers.google.com/chart/interactive/docs/gallery/scatterchart
      visualization.draw(data, 
        {title: 'Interactive Scatter Chart from Google Sheet source, with 3-color data series and legend (Float over points to view data labels)', 
          titleTextStyle: {fontSize: 16},
          vAxis: {title: "Insert Y-axis label", titleTextStyle: {fontSize: 14}, minValue: 0, maxValue: 1, format:'#,###%', gridlines: {count:3}},
          hAxis: {title: "Insert X-axis label", titleTextStyle: {fontSize: 14}, minValue: 0, maxValue: 1, format:'#,###%', gridlines: {count:3}}, 
          legend:'right',colors: ["red","blue", "green"]
        }
                    );
    }
    
    google.setOnLoadCallback(drawVisualization);
    </script>
  </head>
  <body style="font-family: Arial;border: 0 none;">
    <div id="visualization" style="height: 600px; width: 600px;"></div>
    <!-- Remove or insert your own text below -->
    <p>Google Visualization API code and instructions available at</br><a href="https://github.com/JackDougherty/gviz-scatter-series" target="_blank">https://github.com/JackDougherty/gviz-scatter-series</a>
  </body>
</html>